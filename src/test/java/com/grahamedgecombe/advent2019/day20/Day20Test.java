package com.grahamedgecombe.advent2019.day20;

import java.io.IOException;
import java.util.List;

import com.grahamedgecombe.advent2019.Advent;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public final class Day20Test {
	@Test
	public void testPart1() throws IOException {
		assertEquals(23, Grid.parse(List.of(
			"         A           ",
			"         A           ",
			"  #######.#########  ",
			"  #######.........#  ",
			"  #######.#######.#  ",
			"  #######.#######.#  ",
			"  #######.#######.#  ",
			"  #####  B    ###.#  ",
			"BC...##  C    ###.#  ",
			"  ##.##       ###.#  ",
			"  ##...DE  F  ###.#  ",
			"  #####    G  ###.#  ",
			"  #########.#####.#  ",
			"DE..#######...###.#  ",
			"  #.#########.###.#  ",
			"FG..#########.....#  ",
			"  ###########.#####  ",
			"             Z       ",
			"             Z       "
		)).getSteps());

		assertEquals(58, Grid.parse(List.of(
			"                   A               ",
			"                   A               ",
			"  #################.#############  ",
			"  #.#...#...................#.#.#  ",
			"  #.#.#.###.###.###.#########.#.#  ",
			"  #.#.#.......#...#.....#.#.#...#  ",
			"  #.#########.###.#####.#.#.###.#  ",
			"  #.............#.#.....#.......#  ",
			"  ###.###########.###.#####.#.#.#  ",
			"  #.....#        A   C    #.#.#.#  ",
			"  #######        S   P    #####.#  ",
			"  #.#...#                 #......VT",
			"  #.#.#.#                 #.#####  ",
			"  #...#.#               YN....#.#  ",
			"  #.###.#                 #####.#  ",
			"DI....#.#                 #.....#  ",
			"  #####.#                 #.###.#  ",
			"ZZ......#               QG....#..AS",
			"  ###.###                 #######  ",
			"JO..#.#.#                 #.....#  ",
			"  #.#.#.#                 ###.#.#  ",
			"  #...#..DI             BU....#..LF",
			"  #####.#                 #.#####  ",
			"YN......#               VT..#....QG",
			"  #.###.#                 #.###.#  ",
			"  #.#...#                 #.....#  ",
			"  ###.###    J L     J    #.#.###  ",
			"  #.....#    O F     P    #.#...#  ",
			"  #.###.#####.#.#####.#####.###.#  ",
			"  #...#.#.#...#.....#.....#.#...#  ",
			"  #.#####.###.###.#.#.#########.#  ",
			"  #...#.#.....#...#.#.#.#.....#.#  ",
			"  #.###.#####.###.###.#.#.#######  ",
			"  #.#.........#...#.............#  ",
			"  #########.###.###.#############  ",
			"           B   J   C               ",
			"           U   P   P               "
		)).getSteps());

		assertEquals(552, Advent.solvePart1(new Day20()));
	}

	@Test
	public void testPart2() throws IOException {
		assertEquals(396, Grid.parse(List.of(
			"             Z L X W       C                 ",
			"             Z P Q B       K                 ",
			"  ###########.#.#.#.#######.###############  ",
			"  #...#.......#.#.......#.#.......#.#.#...#  ",
			"  ###.#.#.#.#.#.#.#.###.#.#.#######.#.#.###  ",
			"  #.#...#.#.#...#.#.#...#...#...#.#.......#  ",
			"  #.###.#######.###.###.#.###.###.#.#######  ",
			"  #...#.......#.#...#...#.............#...#  ",
			"  #.#########.#######.#.#######.#######.###  ",
			"  #...#.#    F       R I       Z    #.#.#.#  ",
			"  #.###.#    D       E C       H    #.#.#.#  ",
			"  #.#...#                           #...#.#  ",
			"  #.###.#                           #.###.#  ",
			"  #.#....OA                       WB..#.#..ZH",
			"  #.###.#                           #.#.#.#  ",
			"CJ......#                           #.....#  ",
			"  #######                           #######  ",
			"  #.#....CK                         #......IC",
			"  #.###.#                           #.###.#  ",
			"  #.....#                           #...#.#  ",
			"  ###.###                           #.#.#.#  ",
			"XF....#.#                         RF..#.#.#  ",
			"  #####.#                           #######  ",
			"  #......CJ                       NM..#...#  ",
			"  ###.#.#                           #.###.#  ",
			"RE....#.#                           #......RF",
			"  ###.###        X   X       L      #.#.#.#  ",
			"  #.....#        F   Q       P      #.#.#.#  ",
			"  ###.###########.###.#######.#########.###  ",
			"  #.....#...#.....#.......#...#.....#.#...#  ",
			"  #####.#.###.#######.#######.###.###.#.#.#  ",
			"  #.......#.......#.#.#.#.#...#...#...#.#.#  ",
			"  #####.###.#####.#.#.#.#.###.###.#.###.###  ",
			"  #.......#.....#.#...#...............#...#  ",
			"  #############.#.#.###.###################  ",
			"               A O F   N                     ",
			"               A A D   M                     "
		)).getRecursiveSteps());

		assertEquals(6492, Advent.solvePart2(new Day20()));
	}
}
